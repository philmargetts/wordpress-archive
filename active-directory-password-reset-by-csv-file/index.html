<!DOCTYPE html>
<html lang="en-AU"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Active directory password reset by CSV file – Phil Margetts</title><link rel="dns-prefetch" href="//s.w.org"><link rel="stylesheet" id="wp-block-library-css" href="../wp-includes/css/dist/block-library/style.min.css" type="text/css" media="all"><link rel="stylesheet" id="genericons-css" href="../wp-content/themes/independent-publisher-2-wpcom/genericons/genericons.css" type="text/css" media="all"><link rel="stylesheet" id="independent-publisher-2-style-css" href="../wp-content/themes/independent-publisher-2-wpcom/style.css" type="text/css" media="all"><link rel="stylesheet" id="independent-publisher-2-block-style-css" href="../wp-content/themes/independent-publisher-2-wpcom/css/blocks.css" type="text/css" media="all"><script type="text/javascript" src="../wp-includes/js/jquery/jquery.js"></script><script type="text/javascript" src="../wp-includes/js/jquery/jquery-migrate.min.js"></script><style type="text/css" id="syntaxhighlighteranchor"></style><link rel="icon" href="../wp-content/uploads/2018/04/cropped-TwmbaScholar032018_dm_392-2-32x32.jpg" sizes="32x32"><link rel="icon" href="../wp-content/uploads/2018/04/cropped-TwmbaScholar032018_dm_392-2-192x192.jpg" sizes="192x192"><link rel="apple-touch-icon-precomposed" href="../wp-content/uploads/2018/04/cropped-TwmbaScholar032018_dm_392-2-180x180.jpg"><meta name="msapplication-TileImage" content="../wp-content/uploads/2018/04/cropped-TwmbaScholar032018_dm_392-2-270x270.jpg"></head><body class="post-template-default single single-post postid-116 single-format-standard wp-embed-responsive">
<div id="page" class="hfeed site">
<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
<div id="hero-header" class="site-hero-section">
<header id="masthead" class="site-header" role="banner"><div class="inner">
<div class="site-branding">
<a class="site-logo-link" href="../index.html">
<img alt="" class="site-logo-image no-grav" width="80" height="80" src="https://secure.gravatar.com/avatar/9bc396c869aaf97ed80fb82762e597ba?s=160&d=mm&r=g"></a>
<p class="site-title"><a href="../index.html" rel="home">Phil Margetts</a></p>
<p class="site-description">IT Pro in EDU</p>
</div>
<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false" id="primary-menu-button">
Menu </button>
</div>
</header></div>
<nav id="site-navigation" class="main-navigation" role="navigation"><div class="menu-header-container"><ul id="primary-menu" class="menu"><li id="menu-item-132" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-132"><a href="../http://OFFLINEZIP.wpsho">Home</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-41"><a href="../about/index.html">About</a></li>
<li id="menu-item-223" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-223"><a href="../categories/index.html">Categories</a>
<ul class="sub-menu"><li id="menu-item-224" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-224"><a href="../category/general/index.html">General</a></li>
<li id="menu-item-227" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-227"><a href="../category/devices/index.html">Devices</a></li>
<li id="menu-item-228" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-228"><a href="../category/office-365/index.html">Office 365</a></li>
<li id="menu-item-225" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-225"><a href="../category/how-to/index.html">How-to</a></li>
<li id="menu-item-226" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-226"><a href="../category/powershell/index.html">PowerShell</a></li>
</ul></li>
<li id="menu-item-109" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-109"><a href="../resources/index.html">Resources</a></li>
<li id="menu-item-110" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-110"><a href="https://twitter.com/philmargetts_">Twitter</a></li>
</ul></div> </nav><div id="content-wrapper" class="content-wrapper">
<div id="content" class="site-content">
<div id="primary" class="content-area">
<main id="main" class="site-main" role="main"><article id="post-116" class="post-116 post type-post status-publish format-standard hentry category-how-to category-powershell"><header class="entry-header"><h1 class="entry-title">Active directory password reset by CSV file</h1> </header><div class="entry-meta">
<span class="byline">
<a href="../author/philm/index.html" title="Posts by Phil Margetts" rel="author">Phil Margetts</a> </span>
<span class="cat-links">
<a href="../category/how-to/index.html" rel="category tag">How-to</a>, <a href="../category/powershell/index.html" rel="category tag">PowerShell</a> </span>
<span class="published-on">
<time class="entry-date published" datetime="2018-04-24T16:48:58+00:00">April 24, 2018</time><time class="updated" datetime="2019-01-11T07:50:09+00:00">January 11, 2019</time></span>
<span class="word-count">1 Minute</span> </div>
<div class="entry-content">
<p>As an IT pro with a “functional” PowerShell knowledge, I hunted around a bit online looking for a way to do this. None of the solutions I found were doing what I wanted so I thought I’d share my simple solution. In this case, I was looking for a solution to quickly and easily reset and document bulk passwords for restricted student exam accounts.</p>
<p><span id="more-116"></span></p>
<h2>Generate some passwords</h2>
<p>Use an Excel randomisation formula like the one in <a href="../wp-content/uploads/2018/04/SAMPLE-WordRandomizer.xlsx">this spreadsheet</a> to create passwords of your choice. In this instance we’re using some adjectives, animal types and a two-digit number – easy for students to read and type in for an exam.</p>
<h2>Define some accounts/passwords</h2>
<p>Again using Excel (if that’s your thing), create a CSV file with the headings <strong>samAccountName</strong> and <strong>password</strong>. Enter the usernames of the accounts you’d like to update and copy the passwords you’ve just generated. If in Excel, remember to paste the values, not the formula.</p>
<h2>Set some passwords</h2>
<p>Copy this code into a new PowerShell script, modify with the path to your CSV file and run.</p>
<pre class="brush: powershell; title: ; notranslate" title="">
#ensure AD module is imported so things work
Import-Module ActiveDirectory

#set path to CSV file here:
$filepath = "C:\users.csv"

#for each row in the CSV
$passwordList = Import-CSV $filepath | ForEach-Object {

#retrieve the username and password
$username = $_."samAccountName"
$password = $_."password"

#convert password to secure string
$securePassword = ConvertTo-SecureString -String $password -AsPlainText -Force

#set new password
Set-ADAccountPassword -Identity $username -NewPassword $securePassword -Reset

#confirm accounts being updated
Write-Host "Password has been set for: "$username

}

</pre>
</div>
<div class="entry-footer">
</div>
<div class="entry-author-wrapper">
<div class="entry-author">
<div class="author-avatar">
<img alt="" src="https://secure.gravatar.com/avatar/9bc396c869aaf97ed80fb82762e597ba?s=80&d=mm&r=g" srcset="https://secure.gravatar.com/avatar/9bc396c869aaf97ed80fb82762e597ba?s=160&d=mm&r=g 2x" class="avatar avatar-80 photo" height="80" width="80"></div>
<div class="author-heading">
<h2 class="author-title">Published by <span class="author-name">Phil Margetts</span></h2>
</div>
<p class="author-bio">
<a class="author-link" href="../author/philm/index.html" rel="author">
View all posts by Phil Margetts </a>
</p>
</div>
<div class="site-posted-on">
<strong>Published</strong>
<time class="entry-date published" datetime="2018-04-24T16:48:58+00:00">April 24, 2018</time><time class="updated" datetime="2019-01-11T07:50:09+00:00">January 11, 2019</time></div>
</div>
</article><nav class="navigation post-navigation" role="navigation"><h2 class="screen-reader-text">Post navigation</h2>
<div class="nav-links"><div class="nav-previous"><a href="../harness-the-power/index.html" rel="prev"><span class="meta-nav screen-reader-text">Previous Post</span> Harness the power</a></div><div class="nav-next"><a href="../free-office-365-email-signatures-with-powershell/index.html" rel="next"><span class="meta-nav screen-reader-text">Next Post</span> Free Office 365 email signatures with PowerShell</a></div></div>
</nav></main></div>
</div>
<footer id="colophon" class="site-footer" role="contentinfo"><div class="site-info">
<a href="https://wordpress.org/">Proudly powered by WordPress</a>
<span class="sep"> | </span>
Theme: Independent Publisher 2 by <a href="http://raamdev.com/" rel="designer">Raam Dev</a>. </div>
</footer></div>
</div>
<script type="text/javascript" src="../wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js"></script><script type="text/javascript" src="../wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPowerShell.js"></script><script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://OFFLINEZIP.wpsho/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://OFFLINEZIP.wpsho/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();

	// Infinite scroll support
	if ( typeof( jQuery ) !== 'undefined' ) {
		jQuery( function( $ ) {
			$( document.body ).on( 'post-load', function() {
				SyntaxHighlighter.highlight();
			} );
		} );
	}
</script><script type="text/javascript" src="../wp-content/themes/independent-publisher-2-wpcom/js/navigation.js"></script><script type="text/javascript" src="../wp-content/themes/independent-publisher-2-wpcom/js/independent-publisher-2.js"></script><script type="text/javascript" src="../wp-content/themes/independent-publisher-2-wpcom/js/skip-link-focus-fix.js"></script></body></html>
